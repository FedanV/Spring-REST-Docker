CREATE TABLE IF NOT EXISTS car_brand
(
    id    INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    brand VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS car_year
(
    id   INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    year varchar(4) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS car_model
(
    id    INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    model VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS category
(
    id       INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS car
(
    id       INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    brand_id INT REFERENCES car_brand (id) ON DELETE SET NULL,
    year_id  INT REFERENCES car_year (id) ON DELETE SET NULL,
    model_id INT REFERENCES car_model (id) ON DELETE SET NULL
);

CREATE TABLE IF NOT EXISTS car_category
(
    car_id      INT REFERENCES car (id) ON DELETE CASCADE,
    category_id INT REFERENCES category (id) ON DELETE CASCADE,
    PRIMARY KEY (car_id, category_id)
);